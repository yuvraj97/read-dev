<!DOCTYPE HTML>
<html lang="en">

    <head>

        
        <link rel="stylesheet" href="/data/assets/css/main.css">
        <link rel="stylesheet" href="/data/assets/css/authStyle.css">
        <link id="quantml-auth-style" rel="stylesheet" href="">
        <link onload="cssLoaded()" id="quantml-theme" rel="stylesheet" href="" />

        <!--KATEX-->
        <link rel="stylesheet" href="/data/assets/css/katex.min.css">

        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="/data/assets/js/katex.min.js"></script>

        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="/data/assets/js/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

        <title>Delta Method</title>
        <meta charset="utf-8" />
        <link rel="icon" href="/data/icon.png" type="image/png" sizes="16x16">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        
        
    </head>
    <body>
        <div id="pre-loading"><img class="loading" src="/data/img/loading.gif" alt=""></div>

        <!-- Wrapper -->
            <div style="display: none;" id="wrapper">
                <div class="bg fixed" style="transform: none;"></div>
                <div id="navPanelToggle">Menu</div>
            

                <!-- Header -->
                <header id="header">
                    <a href="https://quantml.org" class="logo image jump-big"><img id="quantml-cover" src="/data/img/cover.png" alt="QuantML.org" /></a>
                </header>

                <!-- Nav -->
                    <nav id="nav">
                        <ul class="links">
                            <li class="cover"><a href="/stats/"><img src="/data/img/STATISTICS-cover.png" alt="STATISTICS"></a></li>
                            <li><a href="estimation.html">&#x25C0;</a></li>
                            <li><a href="ci.html">Confidence Interval</a></li>
                            <li class="active"><a href="delta.html">Delta Method</a></li>
                            <li><a href="interpretation.html">Interpretation of CI</a></li>
                            <li><a href="hypothesis.html">&#x25B6;</a></li>
                        </ul>
                        <ul id="nav-bar-icons-head" class="icons">
                        </ul>
                    </nav>


                <!-- Main -->
                    <div id="main">
                        <section id="paragraph" class="post">
<div id="btn-container">
    <button id="prev-btn" class="button" onclick="window.location.href = 'ci.html';">&#x25C0;&nbsp;&nbsp;Confidence Interval</button>
    <button id="next-btn" class="button"  style="float: right;" onclick="window.location.href = 'interpretation.html';">Interpretation of CI&nbsp;&nbsp;&#x25B6;</button>
</div><br>
<p>
<!--&#120793;-->
Say we have \(n\) observation \(X_1,X_2,....,X_n \stackrel{iid}{\sim } X\), \(\ \theta\) is the parameter and \(\hat{\theta}_n\) is estimator of \(\theta\)<br>
Assume:
<ul>
    <li>\(\hat{\theta}_n\) is <b>consistent:</b> \(\hat{\theta}_n \xrightarrow [n\to \infty ]{\mathbb{P,\text{ a.s.}}} \theta\)</li>
    <li>\(\hat{\theta}_n\) is <b>asymptotically normal:</b> <div class="math-container">\(\sqrt{n} (\hat{\theta}_n-\theta ) \xrightarrow [n\to \infty ]{(d)} \mathcal{N}(0,\sigma^2)\)\(\quad ;\theta\in\mathbb{R},\sigma^2 \gt 0\)</div></li>
</ul>
Let \(g:\mathbb{R}\mapsto \mathbb{R}\) be continuously differentiable(it means \(g'\) is continuous) at the point \(\theta\)<br>
Then:<br>
\(g(\hat{\theta}_n)\) is asymptotically normal around \(g(\theta)\)<br>
Using Delta method we will answer: \[\sqrt{n} (g(\hat{\theta}_n)-g(\theta) ) \xrightarrow [n\to \infty ]{(d)} ?\]<br>
By Taylor expansion:<br>
<div class="math-container">
\(g(\hat{\theta}_n)-g(\theta) = \underbrace{(\hat{\theta}_n-\theta)}_{\sim\frac{1}{\sqrt{n}}}g'(\theta)+\frac{1}{2}\underbrace{(\hat{\theta}_n-\theta)^2}_{\sim\frac{1}{n}}g''(\omega)\)  \(\quad; \omega\in\left[\hat{\theta}_n,\theta\right]\)<br>
<br>
\(\hat{\theta}_n-\theta\approx \frac{1}{\sqrt{n}}\) we proved it <a href="/stats/lln/#sqrt-n">HERE</a><br>
\(\Rightarrow g(\hat{\theta}_n)-g(\theta) \approx (\hat{\theta}_n-\theta) g'(\theta)\quad\) as \(n\to\infty\)<br>
<br>
\(\Rightarrow \sqrt{n} \left(g(\hat{\theta}_n)-g(\theta)\right) \approx \underbrace{\sqrt{n} (\hat{\theta}_n-\theta)}_{\xrightarrow [n\to \infty ]{(d)} \mathcal{N}(0,\sigma^2)} g'(\theta)\quad\) as \(n\to\infty\)<br>
<br>
\(\Rightarrow \sqrt{n} \left(g(\hat{\theta}_n)-g(\theta)\right) \xrightarrow [n\to \infty ]{(d)} \mathcal{N}(0,\sigma^2) g'(\theta)\)
</div>
<br>

<div style="background-color: #CCFFCC;" class="math-container"><br>
    \[\Rightarrow \sqrt{n} \left(g(\hat{\theta}_n)-g(\theta)\right) \xrightarrow [n\to \infty ]{(d)} \mathcal{N}\left(0,(g'(\theta))^2\sigma^2\right)\]
<br>
</div>

<b>Example:</b><br>
<dl><dd>
<span id="T"></span>
<a  href="ci.html#T">Remember <b>The T</b>  example</a><br>
\(\hat{\lambda}=\frac{1}{\overline{T}_n} \xrightarrow [n\to \infty ]{\text{ a.s.}/\mathbb{P}/(d)} \lambda\)<br>
There we saw:
<div class="math-container">
    \[\sqrt{n}\left(  \overline{T}_n-\frac{1}{\lambda} \right)   \xrightarrow [n\to \infty ]{d} \mathcal{N}\left(0,\frac{1}{\lambda^2}\right)\]
</div>
But what we want is :
<div class="math-container">
    \[\sqrt{n}\left(  \hat{\lambda}-\lambda \right)   \xrightarrow [n\to \infty ]{d} \mathcal{N}\left(0,\sigma^2\right)\]
</div>
So \(g\) is \(g(x)=1/x\) \(\Rightarrow g'(x)=-1/x^2\)<br>
<div class="math-container">
    \(\Rightarrow \left(g'(\frac{1}{\lambda})\right)^2=\left(\frac{1}{(1/\lambda)^2}\right)^2=\lambda^4\)
</div>

And by Delta method:
<div class="math-container">
    \[
    \sqrt{n}\left(  \frac{1}{\overline{T}_n}-\frac{1}{1/\lambda} \right)   \xrightarrow [n\to \infty ]{d} \mathcal{N}\left(0,(g'(\lambda))^2\frac{1}{\lambda^2}\right)  \\
    \sqrt{n}\left(  \hat{\lambda}-\lambda \right)   \xrightarrow [n\to \infty ]{d} \mathcal{N}\left(0,\lambda^4\frac{1}{\lambda^2}\right)  \\
    \sqrt{n}\left(  \hat{\lambda}-\lambda \right)   \xrightarrow [n\to \infty ]{d} \mathcal{N}\left(0,\lambda^2\right)  \\
    \]
</div>
For \(\alpha\in (0,1)\) and \(n\to\infty\)<br>
<div class="math-container">
\(\mathbb{P}\left(|\hat{\lambda}-\lambda|\leq q_{\alpha/2}\sqrt{\text{Var}(\hat{\lambda})}\right)\approx 1-\alpha\)<br>
</div>
<div class="math-container">
\[\mathbb{P}\left(|\hat{\lambda}-\lambda|\leq \frac{\lambda q_{\alpha/2}}{\sqrt{n}}\right)\approx 1-\alpha\]
</div>
Now let's find the asymptotic confidence interval of \(\hat{\lambda}\)<br>
\(\mathcal{I}=\left[ \hat{\lambda} - \frac{q_{\alpha/2}\lambda}{\sqrt{n}} , \hat{\lambda}+\frac{q_{\alpha/2}\lambda}{\sqrt{n}}  \right]\) but it's not the CI (as it depends on \(\lambda\)).<br>
We have 3 ways to get the CI:
<ol>
    <li>
        Conservative bound:<br>
        Here we took the max variance of \(\hat{\lambda}\) but here maximum variance goes to \(\infty\) so this one is ruled out.
    </li>
    <li>
        Solving an equation:<br>
        <div class="math-container">
        \[
            |\hat{\lambda}-\lambda|\leq \frac{\lambda q_{\alpha/2}}{\sqrt{n}}  \\
            \Rightarrow -\frac{\lambda q_{\alpha/2}}{\sqrt{n}} \leq \hat{\lambda}-\lambda \leq \frac{\lambda q_{\alpha/2}}{\sqrt{n}} \\
            \Rightarrow \lambda-\frac{\lambda q_{\alpha/2}}{\sqrt{n}} \leq \hat{\lambda} \leq \lambda + \frac{\lambda q_{\alpha/2}}{\sqrt{n}} \\
            \Rightarrow \frac{1}{\lambda}\left(1-\frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1} \leq \frac{1}{\hat{\lambda}} \leq \frac{1}{\lambda}\left(1 + \frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1}  \\
            \Rightarrow \hat{\lambda}\left(1-\frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1} \leq \lambda \leq \hat{\lambda} \left(1 + \frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1}
        \]
        </div>
        <div class="math-container">
            \[\Rightarrow \mathcal{I}_{\text{solve}}= \left[\hat{\lambda}\left(1-\frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1} \ ,\  \hat{\lambda} \left(1 + \frac{q_{\alpha/2}}{\sqrt{n}}\right)^{-1}\right]\]
        </div>
    </li>
    <li>
        Plug-in:<br>
        \[\mathcal{I}_{\text{plug-in}}=\left[ \hat{\lambda} - \frac{q_{\alpha/2}\hat{\lambda}}{\sqrt{n}} , \hat{\lambda}+\frac{q_{\alpha/2}\hat{\lambda}}{\sqrt{n}}  \right]\]
    </li>
</ol>

</dd></dl>

</p>
<button class="accordion">\(\text{Discussion}\)</button>
<div class="panel">
    <script src="https://utteranc.es/client.js"
        repo="yuvraj97/stats.github.io"
        issue-term="estimation-delta-discussion"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
</div>
<button class="accordion">\(\text{Put up a question}\)</button>
<div class="panel">
    <script src="https://utteranc.es/client.js"
        repo="yuvraj97/stats.github.io"
        issue-term="estimation-delta-questions"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
</div>
<div class="slack-discuss" onclick=" window.open('https://join.slack.com/t/quantml-org/shared_invite/zt-jffw86bo-6M260iyt1q2MgBma9elewg','_blank','noopener')">
    Join our Slack <img src="/data/img/slack.png" alt="Slack"> discussion forum
</div><br>
<div id="btn-container">
    <button id="prev-btn" class="button" onclick="window.location.href = 'ci.html';">&#x25C0;&nbsp;&nbsp;Confidence Interval</button>
    <button id="next-btn" class="button"  style="float: right;" onclick="window.location.href = 'interpretation.html';">Interpretation of CI&nbsp;&nbsp;&#x25B6;</button>
</div><br>
<div id="modals-html"></div>

                    </section>
</div>
<br><br>

                    </div>
            
            <div id="navPanel"> 
                <nav>
                    <ul class="links">
                        <li class="cover"><a href="/stats/"><img src="/data/img/STATISTICS-cover.png" alt="STATISTICS"></a></li>
                        <li class="active title"><a>Introduction</a></li>
                        <li class="python"><a href="python/"><img src="/data/img/python.png" alt="Python"></a></li>
                        <li class="julia"><a href="julia/"><img src="/data/img/julia.png" alt="Julia"></a></li>
                    </ul>
                    <ul id="nav-bar-icons-foot" class="icons">
                    </ul>
                </nav>
                <div id="close-navbar" class="close"></div>
            </div>

        <!-- Scripts -->
        
        <script src="/data/assets/js/initialize-css.js"></script>
        <script src="/data/assets/js/init.js"></script>
        <script>
            function cssLoaded(){
                document.getElementById('wrapper').style.display="block";
                document.getElementById('pre-loading').style.display="none";
                fullyLoaded()
            }
        </script>
        <script src="/data/assets/js/index.js"></script>
        <script src="/data/assets/js/firebase.js"></script>
    </body>
</html>
