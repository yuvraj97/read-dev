<!-- https://datatofish.com/add-julia-to-jupyter/ -->
<!DOCTYPE HTML>
<html lang="en">

	<head>

		<title>Julia | Gaussian Distribution | Fundamentals of Statistics - QuantML</title>
		<link rel="stylesheet" href="/data/css/main.css">

		<script>
			// var nextPage = "/statistics/gaussian-distribution/";
			var prevPage = "/statistics/central-limit-theorem/";
			// var nextPageTitle = "Gaussian Distribution";
			var prevPageTitle = "Central Limit Theorem";
			var arrowLeftPage = "/statistics/gaussian-distribution/python";
			// var arrowRightPage = "/statistics/NextPage/";
            var importPrism = true
		</script>
		
		<script src="/data/js/initialize.js"></script>
        <script>
            quantml["chapterID"] ="gaussian-distribution-jl";
            quantml["fetch-chapter"] = true;
            quantml["meta"] = {
                "allow-robots": false,
                // "description": "",
                // "image-url": "",
            }
			applyMetaTags()
			// quantml["dont-apply-katex"] = true
        </script>

	</head>

	<body>

		<!-- Wrapper -->
			<div style="display: none;" id="wrapper">
				<div class="bg fixed" style="transform: none;"></div>
				<div id="navPanelToggle">Menu</div>


				<!-- Header -->
				<header id="header">
					<a href="https://quantml.org" style="display: none;" class="logo image jump-big" id="quantml-cover-light"><img src="/data/img/cover.webp" alt="QuantML.org" /></a>
					<a href="https://quantml.org" style="display: none;" class="logo image jump-big" id="quantml-cover-dark"><img src="/data/img-dark/cover.webp" alt="QuantML.org" /></a>
					<script>if(window.quantml["theme"]=="dark") document.getElementById('quantml-cover-dark').style.display = "block";else document.getElementById('quantml-cover-light').style.display = "block";</script>
				</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li class="cover"><a href="/statistics/"><img src="/data/img/STATISTICS-cover.webp" alt="STATISTICS"></a></li>
							<li class="link"><a href="/statistics/gaussian-distribution/">Gaussian Distribution</a></li>
							<li class="python"><a href="/statistics/gaussian-distribution/python/ "><img src="/data/img/python.webp" alt="Python"></a></li>
							<li class="active julia"><img src="/data/img/julia.webp" alt="Julia"></li>
						</ul>
					</nav>

<!-- Main -->
<div id="main">
    <section class="post">
<div style="text-align: center;" id="load-init"></div>
<script>initializeBody();</script>

<div id="paragraph-content" data-swipe-threshold="80">
<div id="desktop-mode"><div id="btn-container"></div><br></div>

<h1>Gaussian Distribution Implementation <img src="/data/img/julia.webp" alt="Julia" width="53px" height="33px"></h1>
Now let's see a real life example for Gaussian Distribution and implement it in <b><a rel="noreferrer" target="_blank" href="https://julialang.org/">Julia</a></b>. <br>
Here we use a dataset containing <div class="quantml-katex-display inline">\(25,000\)</div> record of human heights(inches) and weights(pounds). 
<a href="../height_weight.csv" download="height_weight.csv">Download ⬇</a> <br>
(Source <a rel="noreferrer" target="_blank" href="http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Dinov_020108_HeightsWeights">http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Dinov_020108_HeightsWeights</a>.) <br>
Here we will study how height(inches) is distributed. And you should try to study the distribution of weights(pounds).<br>
So let's get started. <br>


First get the data <a href="../height_weight.csv" download="height_weight.csv">Download ⬇</a> (<a  rel="noreferrer" target="_blank" href="http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Dinov_020108_HeightsWeights">Source</a>). <br>
Now load this data in julia. <br>
<pre data-start="1"><code class="language-julia line-numbers">using DataFrames, CSV, Plots, StatsBase, Statistics, Distributions, Random
population = CSV.read("height_weight.csv", DataFrame) # [Download ⬇](../height_weight.csv)
first(population, 6)
</code></pre>
O/P: 
<img class="full-size-img" src="../../img/gaussian-distribution/jl/dataset-head.png" alt="dataset-head.png ...">
<br>
Now extract all the Heights from the data. <br>

<pre data-start="4"><code class="language-julia line-numbers">population_height = population."Height(Inches)"
population_height[1:5]
</code></pre>
O/P:
<img class="full-size-img" src="../../img/gaussian-distribution/jl/heights-head.png" alt="heights-head.png ..." width="372px" height="196px"><br>

Now let's plot a histogram out of <span class="bb">population_height</span>. <br>
<pre data-start="6"><code class="language-julia line-numbers">num_bins = 100

# Histogram(PMF) of Heights
bins = Array(LinRange(minimum(population_height), maximum(population_height), num_bins))
counts = fit(Histogram, population_height, bins).weights
Plots.histogram(population_height, 
                 bins=bins, 
                 weights=(1/sum(counts)).*ones(length(population_height)), 
                 title = "Height's Distribution",
                 label = false)
Plots.xlabel!("Height(Inches)")
Plots.ylabel!("Proportion of height falling in certain range")
</code></pre>
<img class="full-size-img" src="../../img/gaussian-distribution/jl/height-histogram.png" alt="" width="640px" height="476px">
Histogram looks to be normally distributed. Now let's visually inspect that, does our data follows a  Normal Distribution (with empirical mean and empirical variance)? <br>
So, how can we visually inspect our data to be normally distributed? <br>

One can say that we should impose a Normal Distribution with empirical mean and empirical variance on the height's histogram and see if our data follows a Normal Distribution. <br>
<blockquote class="sidebar">
	The height of histogram denotes the <b>probability</b> of a height falling into certain range, but the height of a Normal Distribution <b>does not</b> denote <b>probability</b>. So we can't get any info by imposing a Normal Distribution on our histogram.
</blockquote>
Let's impose a Normal Distribution on our histogram and see it ourselves. <br>

<img class="full-size-img" src="../../img/gaussian-distribution/jl/height-histogram+normal.png" alt="" width="640px" height="476px">

<details><summary><span class="bb">Code to plot this (julia)</span></summary>
<pre data-start="6"><code class="language-julia line-numbers">num_bins = 100

# Histogram(PMF) of Heights
bins = Array(LinRange(minimum(population_height), maximum(population_height), num_bins))
counts = fit(Histogram, population_height, bins).weights
Plots.histogram(population_height, 
                 bins=bins, 
                 weights=(1/sum(counts)).*ones(length(population_height)), 
                 label = "Height's Distribution")

# PDF of Normal Distribution
_mean, _std = mean(population_height), std(population_height)
rvs = LinRange(_mean - 3 * _std, _mean + 3 * _std, 100)
_pdf = pdf.(Normal(_mean, _std), rvs)
plot!(rvs, _pdf, c="green", label="Normal distribution (PDF)", lw=3)

Plots.xlabel!("Height(Inches)")
Plots.ylabel!("Proportion of height falling in certain range \n PDF of Normal distribution")
</code></pre>
</details><br>

Ok we get that, we can't use <b>PDF</b> to visually justify the normal trend of our data, then what can we use to justify that our data follow a Normal distribution. <br>
<blockquote class="sidebar">
	And the answer is <b>CDF</b>, CDF of Normal distribution and Height's distribution both denote the same thing. So we can overlay CDF of Normal distribution and CDF of Height's distribution on each other, and see if both CDF overlay nicely.
</blockquote>
So let's plot it,

<pre data-start="6"><code class="language-julia line-numbers">num_bins = 100

# CDF of Heights
bins = Array(LinRange(minimum(population_height), maximum(population_height), num_bins))
counts = fit(Histogram, population_height, bins).weights
_cdf = cumsum(counts)/sum(counts)
pop!(bins)
scatter(bins, _cdf, color="blue", markersize=2, label="Height's distribution CDF")

# CDF of Normal Distribution
_mean, _std = mean(population_height), std(population_height)
rvs = LinRange(_mean - 4 * _std, _mean + 4 * _std, 100)
_cdf = cdf.(Normal(_mean, _std), rvs)
plot!(rvs, _cdf, c="green", label="Normal distribution CDF", lw=3)
Plots.xlabel!("Height(Inches)")
Plots.ylabel!("CDF of Height's distribution \n CDF of Normal Distribution")
plot!(legend=:topleft)
</code></pre>
<img class="full-size-img" src="../../img/gaussian-distribution/jl/cdf.png" alt="" width="640px" height="476px">
Now we can say that our data do follow Normal Distribution (with empirical mean and empirical variance). <br>
<br>

<h2>Now Let's answer some questions</h2>
<br>
<blockquote class="sidebar">
	First let's get the empirical mean and empirical variance because we will need then below.
<pre data-start="1"><code class="language-julia line-numbers">using Statistics, DataFrames, CSV
population = CSV.read("height_weight.csv", DataFrame)
population_height = population."Height(Inches)"
_mean, _var = mean(population_height), var(population_height)
println("""
       Empirical Mean:  $_mean
       Empirical Variance: $_var
       """)
</code></pre>
O/P:
<blockquote class="noborder">
	Empirical Mean: 67.99311359679979 <br>
	Empirical Variance: 3.6162374935681028
</blockquote>
So <div class="quantml-katex-display inline">\(\quad\widehat{\mu}=67.9931,\quad\)</div> <div class="quantml-katex-display inline">\(\widehat{\sigma^2}=3.6162\quad\)</div> also <div class="quantml-katex-display inline">\(\quad\widehat{\sigma}=1.9016\)</div>
</blockquote>
<!-- <div style="margin-top: 20px;"></div> -->
<br>
<h4>Question <div class="quantml-katex-display inline">\(1\)</div></h4>
What is the probability of randomly selected human is taller then <div class="quantml-katex-display inline">\(67.12\)</div> inches? <br>
Say <div class="quantml-katex-display inline">\(X\)</div> is a random variable denoting height, then we want to find the probability of <div class="quantml-katex-display inline">\(X\gt 67.12\)</div> or say <div class="quantml-katex-display inline">\(\mathbb{P}(X\gt 67.12)\)</div> <br>
↪ Finding <div class="quantml-katex-display inline">\(\mathbb{P}(X\gt 67.12)\)</div> using mathematics <br>
<blockquote class="sidebar">
We are pretty confident that our height data follows a Normal Distribution. <br>
So we can say that <div class="quantml-katex-display inline">\(X\sim\mathcal{N}(\widehat{\mu},\widehat{\sigma^2})\)</div>, where <div class="quantml-katex-display inline">\(\widehat{\mu}\)</div> is empirical mean and <div class="quantml-katex-display inline">\(\widehat{\sigma^2}\)</div> is empirical variance. <br>
<div class="quantml-katex-display">\[X\sim\mathcal{N}(\widehat{\mu},\widehat{\sigma^2})\]</div>
<div class="quantml-katex-display">\[X - \widehat{\mu} \sim\mathcal{N}(0,\widehat{\sigma^2})\]</div> 
<div style="margin-top: 10px;"></div>
<div class="quantml-katex-display">\[\displaystyle\frac{X - \widehat{\mu}}{\widehat{\sigma}} \sim\mathcal{N}(0,1)\]</div>
So,
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 1- \mathbb{P}\left(X\leq 67.12\right)\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 1- \mathbb{P}\left(\underbrace{\frac{X - \widehat{\mu}}{\widehat{\sigma}}}_{\sim\mathcal{N}(0,1)} \leq \frac{67.12 - \widehat{\mu}}{\widehat{\sigma}}\right)\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 1- \Phi\left(\frac{67.12 - \widehat{\mu}}{\widehat{\sigma}}\right)\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 1- \Phi\left(\frac{67.12 - 67.9931}{1.9016}\right)\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 1- \underbrace{\Phi\left(-0.4591\right)}_{1-\Phi(0.4591)}\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = \Phi(0.4591)\]</div>
<div class="quantml-katex-display">\[\mathbb{P}\left(X\gt 67.12\right) = 0.67724\]</div>
</blockquote>
↪ Finding <div class="quantml-katex-display inline">\(\mathbb{P}(X\gt 67.12)\)</div> using <img src="/data/img/julia.webp" alt="Julia" width="53px" height="33px"> <br>
<blockquote class="sidebar">
<pre data-start="9"><code class="language-julia line-numbers">result = sum(population_height .> 67.12)/length(population_height)
print("Proportion of heights greater then 67.12 inches: $result")
</code></pre>
O/P:
<blockquote class="noborder">Proportion of heights greater then <div class="quantml-katex-display inline">\(67.12\)</div> inches: <div class="quantml-katex-display inline">\(0.67784\)</div></blockquote>
</blockquote>
Both values are pretty close, there's a error of <div class="quantml-katex-display inline">\(\approx 0.9\%\)</div>. <br>
<br>

<h4>Question <div class="quantml-katex-display inline">\(2\)</div></h4>
What is the probability that a randomly selected human has a height between <div class="quantml-katex-display inline">\(59.25\)</div> and <div class="quantml-katex-display inline">\(67.12\)</div> inches? <br>
Say <div class="quantml-katex-display inline">\(X\)</div> is a random variable denoting height, then we want to find the probability of <div class="quantml-katex-display inline">\(59.25 \lt X\lt 67.12\)</div> or say <div class="quantml-katex-display inline">\(\mathbb{P}(59.25 \lt X\lt 67.12)\)</div> <br>
↪ Finding <div class="quantml-katex-display inline">\(\mathbb{P}(59.25 \lt X\lt 67.12)\)</div> using mathematics <br>
<blockquote class="sidebar">
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = \mathbb{P}\left(\frac{59.25 - \hat{\mu}}{\hat{\sigma}} \lt \frac{X - \hat{\mu}}{\hat{\sigma}}\lt \frac{67.12 - \hat{\mu}}{\hat{\sigma}}\right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = \mathbb{P}\left(\frac{59.25 - 67.9931}{1.9016} \lt \underbrace{\frac{X - \hat{\mu}}{\hat{\sigma}}}_{\sim\mathcal{N}(0,1)} \lt \frac{67.12 - 67.9931}{1.9016}\right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = \mathbb{P}\left(-4.6 \lt Z \lt -0.46 \right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = 1 - \left(\mathbb{P}\left(Z \lt -4.6 \right) + \mathbb{P}\left(Z \gt -0.46 \right)\right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = 1 - \left(\mathbb{P}\left(Z \lt -4.6 \right) + \mathbb{P}\left(Z \lt 0.46 \right)\right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = 1 - \left(1 - \mathbb{P}\left(Z \lt 4.6 \right) + \mathbb{P}\left(Z \lt 0.46 \right)\right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = \mathbb{P}\left(Z \lt 4.6 \right) - \mathbb{P}\left(Z \lt 0.46 \right) \]</div>
<div class="quantml-katex-display">\[\mathbb{P}(59.25 \lt X\lt 67.12) = 0.999998 - 0.677242 = 0.322756 \]</div>
</blockquote>

↪ Finding <div class="quantml-katex-display inline">\(\mathbb{P}(59.25 \lt X\lt 67.12)\)</div> using <img src="/data/img/julia.webp" alt="Julia" width="53px" height="33px"> <br>
<blockquote class="sidebar">
<pre data-start="9"><code class="language-julia line-numbers">result = sum((population_height .&gt; 59.25) .& (population_height .&lt; 67.12))/length(population_height)
print("Proportion of heights in between 59.25 and 67.12 inches: $result")
</code></pre>
O/P:
<blockquote class="noborder">Proportion of heights in between <div class="quantml-katex-display inline">\(59.25\)</div> and <div class="quantml-katex-display inline">\(67.12\)</div> inches: <div class="quantml-katex-display inline">\(0.32216\)</div></blockquote>
</blockquote>
Both values are pretty close, there's a error of <div class="quantml-katex-display inline">\(\approx 0.19\%\)</div>. <br>
<br>









<!-- <blockquote class="noborder align-center">
	<a href="/statistics/gaussian-distribution/julia/"><img src="/data/img/julia.webp" alt="Julia" width="53px" height="33px"> Simulation</a>
	<br>
    <a rel="noreferrer" target="_blank" href="https://app.quantml.org/statistics/?ch=Gaussian+Distribution">Visualize Gaussian Distribution &nbsp;<img src="/data/img/app.webp" alt="launch" width="30px" height="30px"></a> <br>
</blockquote> -->

<br><br>


</div>

<div id="btn-container"></div><br>
<div id="modals-html"></div>

</section>
</div><!-- Main [END]-->
</div><!-- Wrapper [END]-->
<script>requireScript('script-js', '0.1.0', '/data/js/script.js', function(){cssLoaded()})</script>

</body>
</html>